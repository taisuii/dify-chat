From 53558ff384c711b364166ce2d9e71473062e33d3 Mon Sep 17 00:00:00 2001
From: name <youxiang@qq.com>
Date: Sun, 25 Jan 2026 18:12:44 +0800
Subject: [PATCH] =?UTF-8?q?=E5=AE=8C=E5=96=84=E7=AC=AC=E4=B8=80=E7=89=88?=
MIME-Version: 1.0
Content-Type: text/plain; charset=UTF-8
Content-Transfer-Encoding: 8bit

---
 packages/react-app/src/App.tsx                |   2 +
 .../src/components/dify-chat/index.tsx        | 281 ++++++++++++++++++
 .../src/components/layout/header.tsx          |  32 +-
 packages/react-app/src/layout/chat-layout.tsx |  58 +++-
 packages/react-app/src/layout/index.tsx       |   3 +
 packages/react-app/src/layout/main-layout.tsx |  14 +-
 packages/react-app/src/pages/simple-chat.tsx  | 216 ++++++++++++++
 7 files changed, 568 insertions(+), 38 deletions(-)
 create mode 100644 packages/react-app/src/components/dify-chat/index.tsx
 create mode 100644 packages/react-app/src/pages/simple-chat.tsx

diff --git a/packages/react-app/src/App.tsx b/packages/react-app/src/App.tsx
index 96925b4..6a935ae 100644
--- a/packages/react-app/src/App.tsx
+++ b/packages/react-app/src/App.tsx
@@ -10,6 +10,7 @@ import LayoutIndex from './layout'
 import AppListPage from './pages/apps'
 import AuthPage from './pages/auth'
 import ChatPage from './pages/chat'
+import SimpleChatPage from './pages/simple-chat'
 import '@/libs/i18n'
 import { useTranslation } from 'react-i18next'
 
@@ -21,6 +22,7 @@ const routes: IRoute[] = [
 	{ path: '/chat', component: () => <ChatPage /> },
 	{ path: '/app/:appId', component: () => <ChatPage /> },
 	{ path: '/apps', component: () => <AppListPage /> },
+	{ path: '/simple-chat', component: () => <SimpleChatPage /> },
 ]
 
 /**
diff --git a/packages/react-app/src/components/dify-chat/index.tsx b/packages/react-app/src/components/dify-chat/index.tsx
new file mode 100644
index 0000000..9f54bab
--- /dev/null
+++ b/packages/react-app/src/components/dify-chat/index.tsx
@@ -0,0 +1,281 @@
+/**
+ * DifyChat - å°è£…çš„ Dify å¯¹è¯ç»„ä»¶ï¼ˆå¤ç”¨å®˜æ–¹ MainLayout + ChatLayout + ChatboxWrapperï¼‰
+ *
+ * åªéœ€ä¼ å…¥ apiBaseã€apiKey å³å¯ä½¿ç”¨ï¼Œä½“éªŒä¸å®˜ç½‘ä¸€è‡´ï¼ˆå«ä¸æ»‘ suggestionã€å¼€åœºç™½ç­‰ï¼‰ï¼Œ
+ * æ— åº”ç”¨åˆ‡æ¢ã€æ—  Debugï¼Œé€‚åˆåµŒå…¥å…¶ä»–ç½‘ç«™ã€‚
+ *
+ * ä½¿ç”¨ç¤ºä¾‹ï¼š
+ * ```tsx
+ * import { DifyChat } from '@/components/dify-chat'
+ * 
+ * // åŸºç¡€ç”¨æ³•
+ * <DifyChat apiBase="https://api.dify.ai/v1" apiKey="app-xxx" />
+ * 
+ * // å¸¦ç”¨æˆ·ID
+ * <DifyChat apiBase="..." apiKey="..." user="user-123" />
+ * 
+ * // éå—æ§æ¨¡å¼ï¼šè®¾ç½®åˆå§‹å€¼ï¼Œå†…éƒ¨åˆ‡æ¢æ—¶é€šçŸ¥å¤–éƒ¨
+ * <DifyChat
+ *   apiBase="..."
+ *   apiKey="..."
+ *   initialTheme="dark"
+ *   initialLanguage="zh"
+ *   onThemeChange={(theme) => {
+ *     // ç»„ä»¶å†…éƒ¨åˆ‡æ¢ä¸»é¢˜æ—¶ï¼ŒåŒæ­¥åˆ°ç½‘ç«™
+ *     console.log('ä¸»é¢˜åˆ‡æ¢:', theme)
+ *   }}
+ *   onLanguageChange={(lang) => {
+ *     // ç»„ä»¶å†…éƒ¨åˆ‡æ¢è¯­è¨€æ—¶ï¼ŒåŒæ­¥åˆ°ç½‘ç«™
+ *     console.log('è¯­è¨€åˆ‡æ¢:', lang)
+ *   }}
+ * />
+ * 
+ * // å—æ§æ¨¡å¼ï¼šç½‘ç«™åˆ‡æ¢æ—¶ï¼Œç»„ä»¶åŒæ­¥ï¼ˆæ¨èç”¨äºåµŒå…¥åœºæ™¯ï¼‰
+ * const [theme, setTheme] = useState('dark')
+ * const [language, setLanguage] = useState('zh')
+ * 
+ * // ç½‘ç«™åˆ‡æ¢ä¸»é¢˜æ—¶
+ * const handleWebsiteThemeChange = (newTheme) => {
+ *   setTheme(newTheme) // DifyChat ä¼šè‡ªåŠ¨åŒæ­¥
+ * }
+ * 
+ * <DifyChat
+ *   apiBase="..."
+ *   apiKey="..."
+ *   theme={theme}        // å—æ§ï¼šç½‘ç«™æ”¹å˜æ—¶ç»„ä»¶åŒæ­¥
+ *   language={language}   // å—æ§ï¼šç½‘ç«™æ”¹å˜æ—¶ç»„ä»¶åŒæ­¥
+ *   onThemeChange={(theme) => {
+ *     // ç»„ä»¶å†…éƒ¨åˆ‡æ¢æ—¶ï¼ŒåŒæ­¥åˆ°ç½‘ç«™
+ *     setTheme(theme)
+ *   }}
+ *   onLanguageChange={(lang) => {
+ *     // ç»„ä»¶å†…éƒ¨åˆ‡æ¢æ—¶ï¼ŒåŒæ­¥åˆ°ç½‘ç«™
+ *     setLanguage(lang)
+ *   }}
+ * />
+ * ```
+ */
+
+import { createDifyApiInstance } from '@dify-chat/api'
+import {
+	AppContextProvider,
+	DEFAULT_APP_SITE_SETTING,
+	type ICurrentApp,
+	type IDifyAppItem,
+} from '@dify-chat/core'
+import { generateUuidV4, LocalStorageKeys, LocalStorageStore } from '@dify-chat/helpers'
+import { ThemeModeEnum } from '@dify-chat/theme'
+import { Button, Empty, message, Spin } from 'antd'
+import { useState, useEffect, useCallback, useRef } from 'react'
+import { useTranslation } from 'react-i18next'
+import { useThemeContext } from '@dify-chat/theme'
+
+import MainLayout from '@/layout/main-layout'
+import { useGlobalStore } from '@/store'
+import type { IGetAppParametersResponse } from '@dify-chat/api'
+
+export interface DifyChatProps {
+	apiBase: string
+	apiKey: string
+	user?: string
+	/** åˆå§‹ä¸»é¢˜æ¨¡å¼ï¼ˆéå—æ§ï¼Œä»…åœ¨æŒ‚è½½æ—¶è®¾ç½®ä¸€æ¬¡ï¼‰ */
+	initialTheme?: 'light' | 'dark' | 'system'
+	/** åˆå§‹è¯­è¨€ï¼ˆéå—æ§ï¼Œä»…åœ¨æŒ‚è½½æ—¶è®¾ç½®ä¸€æ¬¡ï¼‰ */
+	initialLanguage?: 'en' | 'zh'
+	/** å—æ§ä¸»é¢˜æ¨¡å¼ï¼ˆå¤–éƒ¨å¯éšæ—¶æ”¹å˜ï¼Œç»„ä»¶ä¼šåŒæ­¥ï¼‰ */
+	theme?: 'light' | 'dark' | 'system'
+	/** å—æ§è¯­è¨€ï¼ˆå¤–éƒ¨å¯éšæ—¶æ”¹å˜ï¼Œç»„ä»¶ä¼šåŒæ­¥ï¼‰ */
+	language?: 'en' | 'zh'
+	/** ä¸»é¢˜å˜åŒ–å›è°ƒï¼ˆç»„ä»¶å†…éƒ¨åˆ‡æ¢æ—¶é€šçŸ¥å¤–éƒ¨ï¼‰ */
+	onThemeChange?: (theme: 'light' | 'dark' | 'system') => void
+	/** è¯­è¨€å˜åŒ–å›è°ƒï¼ˆç»„ä»¶å†…éƒ¨åˆ‡æ¢æ—¶é€šçŸ¥å¤–éƒ¨ï¼‰ */
+	onLanguageChange?: (language: 'en' | 'zh') => void
+	onError?: (error: Error) => void
+}
+
+export function DifyChat(props: DifyChatProps) {
+	const {
+		apiBase,
+		apiKey,
+		user: userProp,
+		initialTheme,
+		initialLanguage,
+		theme: controlledTheme,
+		language: controlledLanguage,
+		onThemeChange,
+		onLanguageChange,
+		onError,
+	} = props
+	const [defaultUser] = useState(() => generateUuidV4())
+	const user = userProp ?? defaultUser
+
+	const [loading, setLoading] = useState(true)
+	const [error, setError] = useState<string | null>(null)
+	const [currentApp, setCurrentApp] = useState<ICurrentApp | undefined>(undefined)
+	const [isInitialized, setIsInitialized] = useState(false)
+
+	const { setDifyApi: setGlobalDifyApi } = useGlobalStore()
+	const { themeMode, setThemeMode } = useThemeContext()
+	const { i18n } = useTranslation()
+	const onErrorRef = useRef(onError)
+	const onThemeChangeRef = useRef(onThemeChange)
+	const onLanguageChangeRef = useRef(onLanguageChange)
+	const lastControlledThemeRef = useRef(controlledTheme)
+	const lastControlledLanguageRef = useRef(controlledLanguage)
+	onErrorRef.current = onError
+	onThemeChangeRef.current = onThemeChange
+	onLanguageChangeRef.current = onLanguageChange
+
+	// è®¾ç½®åˆå§‹ä¸»é¢˜å’Œè¯­è¨€ï¼ˆéå—æ§æ¨¡å¼ï¼Œä»…åœ¨æŒ‚è½½æ—¶æ‰§è¡Œä¸€æ¬¡ï¼‰
+	useEffect(() => {
+		if (isInitialized) return
+		if (initialTheme !== undefined && controlledTheme === undefined) {
+			const themeModeValue =
+				initialTheme === 'system'
+					? ThemeModeEnum.SYSTEM
+					: initialTheme === 'dark'
+						? ThemeModeEnum.DARK
+						: ThemeModeEnum.LIGHT
+			LocalStorageStore.set(LocalStorageKeys.THEME_MODE, themeModeValue)
+			setThemeMode(themeModeValue)
+		}
+		if (initialLanguage !== undefined && controlledLanguage === undefined) {
+			i18n.changeLanguage(initialLanguage)
+		}
+		setIsInitialized(true)
+		// eslint-disable-next-line react-hooks/exhaustive-deps
+	}, []) // åªåœ¨æŒ‚è½½æ—¶æ‰§è¡Œä¸€æ¬¡
+
+	// å—æ§æ¨¡å¼ï¼šå¤–éƒ¨æ”¹å˜ theme prop æ—¶åŒæ­¥
+	useEffect(() => {
+		if (controlledTheme !== undefined && controlledTheme !== lastControlledThemeRef.current) {
+			lastControlledThemeRef.current = controlledTheme
+			const themeModeValue =
+				controlledTheme === 'system'
+					? ThemeModeEnum.SYSTEM
+					: controlledTheme === 'dark'
+						? ThemeModeEnum.DARK
+						: ThemeModeEnum.LIGHT
+			LocalStorageStore.set(LocalStorageKeys.THEME_MODE, themeModeValue)
+			setThemeMode(themeModeValue)
+		}
+	}, [controlledTheme, setThemeMode])
+
+	// å—æ§æ¨¡å¼ï¼šå¤–éƒ¨æ”¹å˜ language prop æ—¶åŒæ­¥
+	useEffect(() => {
+		if (controlledLanguage !== undefined && controlledLanguage !== lastControlledLanguageRef.current) {
+			lastControlledLanguageRef.current = controlledLanguage
+			i18n.changeLanguage(controlledLanguage)
+		}
+	}, [controlledLanguage, i18n])
+
+	// ç›‘å¬å†…éƒ¨ä¸»é¢˜å˜åŒ–ï¼ˆéå—æ§æ¨¡å¼æˆ–å†…éƒ¨åˆ‡æ¢æ—¶é€šçŸ¥å¤–éƒ¨ï¼‰
+	useEffect(() => {
+		// å¦‚æœæ˜¯å—æ§æ¨¡å¼ï¼Œä¸é€šçŸ¥å¤–éƒ¨ï¼ˆé¿å…å¾ªç¯ï¼‰
+		if (controlledTheme !== undefined) return
+		const currentTheme =
+			themeMode === ThemeModeEnum.SYSTEM
+				? 'system'
+				: themeMode === ThemeModeEnum.DARK
+					? 'dark'
+					: 'light'
+		onThemeChangeRef.current?.(currentTheme)
+	}, [themeMode, controlledTheme])
+
+	// ç›‘å¬å†…éƒ¨è¯­è¨€å˜åŒ–ï¼ˆéå—æ§æ¨¡å¼æˆ–å†…éƒ¨åˆ‡æ¢æ—¶é€šçŸ¥å¤–éƒ¨ï¼‰
+	useEffect(() => {
+		// å¦‚æœæ˜¯å—æ§æ¨¡å¼ï¼Œä¸é€šçŸ¥å¤–éƒ¨ï¼ˆé¿å…å¾ªç¯ï¼‰
+		if (controlledLanguage !== undefined) return
+		const currentLang = i18n.language === 'zh' ? 'zh' : 'en'
+		onLanguageChangeRef.current?.(currentLang)
+	}, [i18n.language, controlledLanguage])
+
+	const connect = useCallback(async () => {
+		if (!apiBase || !apiKey) return
+		setError(null)
+		setLoading(true)
+		try {
+			const api = createDifyApiInstance({ apiBase, apiKey, user })
+			const timeout = new Promise<never>((_, reject) =>
+				setTimeout(() => reject(new Error('è¿æ¥è¶…æ—¶ï¼Œè¯·æ£€æŸ¥ API åœ°å€å’Œç½‘ç»œ')), 10000),
+			)
+
+			const [info, params, site] = (await Promise.race([
+				Promise.all([
+					api.getAppInfo(),
+					api.getAppParameters(),
+					api.getAppSiteSetting().catch(() => DEFAULT_APP_SITE_SETTING),
+				]),
+				timeout,
+			])) as [IDifyAppItem['info'], IGetAppParametersResponse, typeof DEFAULT_APP_SITE_SETTING]
+
+			const config: IDifyAppItem = {
+				id: 'simple',
+				isEnabled: 1,
+				info,
+				requestConfig: { apiBase, apiKey },
+			}
+
+			setGlobalDifyApi(api as any)
+			setCurrentApp({ config, parameters: params, site })
+		} catch (e) {
+			const err = e instanceof Error ? e : new Error(String(e))
+			setError(err.message)
+			onErrorRef.current?.(err)
+			message.error(`è¿æ¥å¤±è´¥: ${err.message}`)
+		} finally {
+			setLoading(false)
+		}
+		// ä»…ä¾èµ– apiBase/apiKey/userï¼Œé¿å… onErrorã€setGlobalDifyApi å¼•ç”¨å˜åŒ–å¯¼è‡´ useEffect åå¤è·‘ â†’ ä¸€ç›´è¯·æ±‚
+		// eslint-disable-next-line react-hooks/exhaustive-deps -- onError ç”¨ refï¼ŒsetGlobalDifyApi ä»…è°ƒç”¨ä¸å‚ä¸é—­åŒ…
+	}, [apiBase, apiKey, user])
+
+	useEffect(() => {
+		connect()
+	}, [connect])
+
+	if (error) {
+		return (
+			<div className="flex h-full items-center justify-center bg-theme-bg">
+				<Empty
+					description={
+						<span>
+							è¿æ¥å¤±è´¥ï¼š{error}
+							<br />
+							<Button type="link" onClick={connect}>é‡è¯•</Button>
+						</span>
+					}
+				/>
+			</div>
+		)
+	}
+
+	if (loading || !currentApp) {
+		return (
+			<div className="flex h-full items-center justify-center bg-theme-bg">
+				<Spin size="large" />
+			</div>
+		)
+	}
+
+	return (
+		<div className="h-full w-full">
+			<AppContextProvider
+				value={{
+					appLoading: false,
+					currentAppId: 'simple',
+					setCurrentAppId: () => {},
+					currentApp,
+					setCurrentApp,
+				}}
+			>
+				<MainLayout
+					initLoading={false}
+					headerMode="none"
+					renderCenterTitle={info => (info ? <span>{info.name}</span> : null)}
+					extComponents={null}
+				/>
+			</AppContextProvider>
+		</div>
+	)
+}
diff --git a/packages/react-app/src/components/layout/header.tsx b/packages/react-app/src/components/layout/header.tsx
index a23a314..179a1d7 100644
--- a/packages/react-app/src/components/layout/header.tsx
+++ b/packages/react-app/src/components/layout/header.tsx
@@ -30,6 +30,10 @@ export interface IHeaderLayoutProps {
 	 * è‡ªå®šä¹‰ Logo æ¸²æŸ“
 	 */
 	renderLogo?: () => React.ReactNode
+	/** éšè—å·¦ä¾§ Logoï¼ˆå¦‚åµŒå…¥æ€ä»…ä¿ç•™è¯­è¨€åˆ‡æ¢ï¼‰ */
+	hideLogo?: boolean
+	/** éšè—ä¸­é—´æ ‡é¢˜ */
+	hideTitle?: boolean
 }
 
 const HeaderSiderIcon = (props: { align: 'left' | 'right'; children: React.ReactNode }) => {
@@ -50,31 +54,27 @@ const HeaderSiderIcon = (props: { align: 'left' | 'right'; children: React.React
  * å¤´éƒ¨å¸ƒå±€ç»„ä»¶
  */
 export default function HeaderLayout(props: IHeaderLayoutProps) {
-	const { isTitleWrapped, title, rightIcon, logoText, renderLogo } = props
+	const { isTitleWrapped, title, rightIcon, logoText, renderLogo, hideLogo, hideTitle } = props
 	const { themeMode } = useThemeContext()
 	const isMobile = useIsMobile()
 	return (
 		<div className="flex h-16 items-center justify-between px-4">
-			{/* ğŸŒŸ Logo */}
 			<HeaderSiderIcon align="left">
-				<Logo
-					text={logoText}
-					renderLogo={renderLogo}
-					hideText={isMobile}
-					hideGithubIcon
-				/>
+				{hideLogo ? null : (
+					<Logo
+						text={logoText}
+						renderLogo={renderLogo}
+						hideText={isMobile}
+						hideGithubIcon
+					/>
+				)}
 			</HeaderSiderIcon>
 
-			{/* ä¸­é—´æ ‡é¢˜ */}
-			{isTitleWrapped ? title : <CenterTitleWrapper>{title}</CenterTitleWrapper>}
+			{hideTitle ? null : isTitleWrapped ? title : <CenterTitleWrapper>{title}</CenterTitleWrapper>}
 
-			{/* å³ä¾§å›¾æ ‡ */}
 			<HeaderSiderIcon align="right">
-				{rightIcon || (
-					<Space
-						className="flex items-center"
-						size={16}
-					>
+				{rightIcon ?? (
+					<Space className="flex items-center" size={16}>
 						<ThemeSelector>
 							<div className="flex cursor-pointer items-center">
 								<LucideIcon
diff --git a/packages/react-app/src/layout/chat-layout.tsx b/packages/react-app/src/layout/chat-layout.tsx
index e536d24..ebb02b3 100644
--- a/packages/react-app/src/layout/chat-layout.tsx
+++ b/packages/react-app/src/layout/chat-layout.tsx
@@ -8,7 +8,7 @@ import {
 import { IConversationItem } from '@dify-chat/api'
 import { ConversationsContextProvider, IDifyAppItem, useAppContext } from '@dify-chat/core'
 import { generateUuidV4, isTempId, useIsMobile } from '@dify-chat/helpers'
-import { ThemeModeEnum, ThemeModeLabelEnum, useThemeContext } from '@dify-chat/theme'
+import { ThemeModeEnum, ThemeModeLabelEnum } from '@dify-chat/theme'
 import {
 	Button,
 	Dropdown,
@@ -20,6 +20,7 @@ import {
 	Modal,
 	Popover,
 	Radio,
+	Space,
 	Spin,
 	Tooltip,
 } from 'antd'
@@ -27,8 +28,9 @@ import dayjs from 'dayjs'
 import { useSearchParams } from 'pure-react-router'
 import React, { useEffect, useEffectEvent, useMemo, useState } from 'react'
 
-import { AppIcon, AppInfo, ConversationList, LucideIcon } from '@/components'
-import { HeaderLayout } from '@/components'
+import { AppIcon, AppInfo, ConversationList, HeaderLayout, LucideIcon } from '@/components'
+import I18nSwitcher from '@/components/i18n-switcher'
+import { ThemeSelector, useThemeContext } from '@dify-chat/theme'
 import ChatboxWrapper from '@/components/chatbox-wrapper'
 import { DEFAULT_CONVERSATION_NAME } from '@/constants'
 import { useLatest } from '@/hooks/use-latest'
@@ -52,12 +54,42 @@ interface IChatLayoutProps {
 	 * æ˜¯å¦æ­£åœ¨åŠ è½½åº”ç”¨é…ç½®
 	 */
 	initLoading: boolean
+	/**
+	 * å¤´éƒ¨æ¨¡å¼ï¼šfull-å®Œæ•´å¤´éƒ¨ï¼Œminimal-ä»…ä¿ç•™ä¸»é¢˜/è¯­è¨€åˆ‡æ¢ï¼Œnone-å®Œå…¨éšè—å¤´éƒ¨
+	 */
+	headerMode?: 'full' | 'minimal' | 'none'
+}
+
+/**
+ * Minimal æ¨¡å¼ä¸‹çš„å¤´éƒ¨æ§åˆ¶ï¼ˆä¸»é¢˜åˆ‡æ¢ + è¯­è¨€åˆ‡æ¢ï¼‰
+ */
+const MinimalHeaderControls = () => {
+	const { themeMode } = useThemeContext()
+	return (
+		<Space className="flex items-center" size={16}>
+			<ThemeSelector>
+				<div className="flex cursor-pointer items-center">
+					<LucideIcon
+						name={
+							themeMode === 'dark'
+								? 'moon-star'
+								: themeMode === 'light'
+									? 'sun'
+									: 'screen-share'
+						}
+						size={20}
+					/>
+				</div>
+			</ThemeSelector>
+			<I18nSwitcher />
+		</Space>
+	)
 }
 
 export default function ChatLayout(props: IChatLayoutProps) {
 	const { t, i18n } = useTranslation()
 	const { difyApi } = useGlobalStore()
-	const { extComponents, renderCenterTitle, initLoading } = props
+	const { extComponents, renderCenterTitle, initLoading, headerMode = 'full' } = props
 	const [sidebarOpen, setSidebarOpen] = useState(true)
 	const { themeMode, setThemeMode } = useThemeContext()
 	const { appLoading, currentApp } = useAppContext()
@@ -396,12 +428,17 @@ export default function ChatLayout(props: IChatLayoutProps) {
 				currentConversationInfo,
 			}}
 		>
-			<div className={`flex h-screen w-full flex-col overflow-hidden bg-theme-bg`}>
+			<div className={`flex h-full w-full flex-col overflow-hidden bg-theme-bg`}>
 				{/* å¤´éƒ¨ */}
-				<HeaderLayout
-					title={renderCenterTitle?.(currentApp?.config?.info)}
-					rightIcon={
-						isMobile ? (
+				{headerMode !== 'none' && (
+					<HeaderLayout
+						hideLogo={headerMode === 'minimal'}
+						hideTitle={headerMode === 'minimal'}
+						title={renderCenterTitle?.(currentApp?.config?.info)}
+						rightIcon={
+							headerMode === 'minimal' ? (
+								<MinimalHeaderControls />
+							) : isMobile ? (
 							<Dropdown
 								menu={{
 									className: '!pb-3 w-[80vw]',
@@ -413,7 +450,8 @@ export default function ChatLayout(props: IChatLayoutProps) {
 							</Dropdown>
 						) : null
 					}
-				/>
+					/>
+				)}
 
 				{/* Main */}
 				<div className="flex flex-1 overflow-hidden rounded-t-3xl bg-theme-main-bg">
diff --git a/packages/react-app/src/layout/index.tsx b/packages/react-app/src/layout/index.tsx
index abcb7f1..bcbd0c9 100644
--- a/packages/react-app/src/layout/index.tsx
+++ b/packages/react-app/src/layout/index.tsx
@@ -14,6 +14,9 @@ const RedirectWrapper = () => {
 	useEffect(() => {
 		const pathname = history.location.pathname
 
+		// /simple-chat å…ç™»å½•ï¼Œä»…å¡« apiBase/apiKey å³å¯ç”¨
+		if (pathname === '/simple-chat') return
+
 		// å¦‚æœæœªç™»å½•ï¼Œåˆ™è·³è½¬ç™»å½•
 		if (!isAuthorized && pathname !== '/auth') {
 			goAuthorize()
diff --git a/packages/react-app/src/layout/main-layout.tsx b/packages/react-app/src/layout/main-layout.tsx
index 711648b..0aece8e 100644
--- a/packages/react-app/src/layout/main-layout.tsx
+++ b/packages/react-app/src/layout/main-layout.tsx
@@ -10,22 +10,12 @@ import CommonLayout from './common-layout'
 import WorkflowLayout from './workflow-layout'
 
 interface IMainLayoutProps {
-	/**
-	 * æ‰©å±•çš„ JSX å…ƒç´ , å¦‚æŠ½å±‰/å¼¹çª—ç­‰
-	 */
 	extComponents?: React.ReactNode
-	/**
-	 * è‡ªå®šä¹‰ä¸­å¿ƒæ ‡é¢˜
-	 */
 	renderCenterTitle?: (appInfo?: IDifyAppItem['info']) => React.ReactNode
-	/**
-	 * è‡ªå®šä¹‰å³ä¾§å¤´éƒ¨å†…å®¹
-	 */
 	renderRightHeader?: () => React.ReactNode
-	/**
-	 * æ˜¯å¦æ­£åœ¨åŠ è½½åº”ç”¨é…ç½®
-	 */
 	initLoading: boolean
+	/** å¤´éƒ¨æ¨¡å¼ï¼šfull-å®Œæ•´å¤´éƒ¨ï¼Œminimal-ä»…ä¿ç•™ä¸»é¢˜/è¯­è¨€åˆ‡æ¢ï¼Œnone-å®Œå…¨éšè—å¤´éƒ¨ */
+	headerMode?: 'full' | 'minimal' | 'none'
 }
 
 /**
diff --git a/packages/react-app/src/pages/simple-chat.tsx b/packages/react-app/src/pages/simple-chat.tsx
new file mode 100644
index 0000000..7aae3e3
--- /dev/null
+++ b/packages/react-app/src/pages/simple-chat.tsx
@@ -0,0 +1,216 @@
+/**
+ * ç®€å•èŠå¤©æµ‹è¯•é¡µé¢
+ *
+ * æ¼”ç¤ºå¦‚ä½•ä½¿ç”¨å°è£…çš„ DifyChat ç»„ä»¶ã€‚
+ * å…ˆå¡«å†™ apiBaseã€apiKeyï¼Œè¿æ¥æˆåŠŸåå³æ¸²æŸ“ DifyChatã€‚
+ *
+ * ä½¿ç”¨æ–¹æ³•ï¼š
+ * 1. .env ä¸­è®¾ç½® PUBLIC_DEBUG_MODE=true
+ * 2. è®¿é—® http://localhost:5200/dify-chat/simple-chat
+ * 3. å¡«å†™ API é…ç½®åè¿æ¥
+ *
+ * åœ¨å…¶ä»–ç½‘ç«™æ¥å…¥æ—¶ï¼Œç›´æ¥ä½¿ç”¨ DifyChat ç»„ä»¶ï¼Œä¼ å…¥ apiBaseã€apiKey å³å¯ï¼š
+ * ```tsx
+ * import { DifyChat } from '@/components/dify-chat'
+ * <DifyChat apiBase="https://api.dify.ai/v1" apiKey="app-xxx" />
+ * ```
+ */
+
+import { generateUuidV4, LocalStorageKeys, LocalStorageStore } from '@dify-chat/helpers'
+import { ThemeModeEnum } from '@dify-chat/theme'
+import { Button, Card, Dropdown, Form, Input, message, Space } from 'antd'
+import { useState, useEffect } from 'react'
+import { useTranslation } from 'react-i18next'
+import { useThemeContext } from '@dify-chat/theme'
+import { LucideIcon } from '@/components'
+
+import { DifyChat } from '@/components/dify-chat'
+
+interface Config {
+	apiBase: string
+	apiKey: string
+	user: string
+}
+
+export default function SimpleChatPage() {
+	const [config, setConfig] = useState<Config | null>(null)
+	const [form] = Form.useForm()
+	const { themeMode, setThemeMode } = useThemeContext()
+	const { i18n } = useTranslation()
+	
+	// å—æ§çš„ä¸»é¢˜å’Œè¯­è¨€çŠ¶æ€ï¼ˆç”¨äº DifyChatï¼‰
+	const [theme, setTheme] = useState<'light' | 'dark' | 'system'>('system')
+	const [language, setLanguage] = useState<'en' | 'zh'>('zh')
+
+	// åˆå§‹åŒ–æ—¶ä» localStorage è¯»å–
+	useEffect(() => {
+		const savedTheme = LocalStorageStore.get(LocalStorageKeys.THEME_MODE) || ThemeModeEnum.SYSTEM
+		const savedLang = i18n.language || 'zh'
+		setTheme(
+			savedTheme === ThemeModeEnum.SYSTEM
+				? 'system'
+				: savedTheme === ThemeModeEnum.DARK
+					? 'dark'
+					: 'light',
+		)
+		setLanguage(savedLang === 'zh' ? 'zh' : 'en')
+		// eslint-disable-next-line react-hooks/exhaustive-deps
+	}, [])
+
+	const onFinish = (values: Config) => {
+		const user = values.user || generateUuidV4()
+		LocalStorageStore.set(LocalStorageKeys.USER_ID, user)
+		setConfig({
+			apiBase: values.apiBase,
+			apiKey: values.apiKey,
+			user,
+		})
+		message.success('é…ç½®å·²ä¿å­˜ï¼Œæ­£åœ¨è¿æ¥â€¦')
+	}
+
+	const handleThemeChange = (newTheme: 'light' | 'dark' | 'system') => {
+		setTheme(newTheme)
+		const themeModeValue =
+			newTheme === 'system'
+				? ThemeModeEnum.SYSTEM
+				: newTheme === 'dark'
+					? ThemeModeEnum.DARK
+					: ThemeModeEnum.LIGHT
+		setThemeMode(themeModeValue)
+	}
+
+	const handleLanguageChange = (newLang: 'en' | 'zh') => {
+		setLanguage(newLang)
+		i18n.changeLanguage(newLang)
+	}
+
+	if (!config) {
+		return (
+			<div className="flex h-screen items-center justify-center bg-gray-50">
+				<Card title="Dify Chat é…ç½®" className="w-full max-w-md">
+					<Form
+						form={form}
+						layout="vertical"
+						onFinish={onFinish}
+						initialValues={{
+							apiBase: 'https://ai.sngzs.site/v1',
+							user: generateUuidV4(),
+						}}
+					>
+						<Form.Item
+							name="apiBase"
+							label="API Base"
+							rules={[{ required: true, message: 'è¯·è¾“å…¥ API Base' }]}
+						>
+							<Input placeholder=" https://ai.sngzs.site/v1" />
+						</Form.Item>
+						<Form.Item
+							name="apiKey"
+							label="API Key"
+							rules={[{ required: true, message: 'è¯·è¾“å…¥ API Key' }]}
+						>
+							<Input.Password placeholder="app-xxx" />
+
+						</Form.Item>
+						<Form.Item name="user" label="ç”¨æˆ· IDï¼ˆå¯é€‰ï¼‰">
+							<Input placeholder="ä¸å¡«åˆ™è‡ªåŠ¨ç”Ÿæˆ" />
+						</Form.Item>
+						<Form.Item>
+							<Button type="primary" htmlType="submit" block>
+								è¿æ¥
+							</Button>
+						</Form.Item>
+					</Form>
+				</Card>
+			</div>
+		)
+	}
+
+	return (
+		<div className="flex h-screen flex-col">
+			{/* é¡¶éƒ¨æ§åˆ¶æ ï¼šä¸»é¢˜å’Œè¯­è¨€åˆ‡æ¢ */}
+			<div className="flex h-16 items-center justify-end border-b border-gray-200 bg-white px-4 dark:border-gray-700 dark:bg-gray-800">
+				<Space size={16}>
+					{/* ä¸»é¢˜åˆ‡æ¢ */}
+					<Dropdown
+						placement="bottomRight"
+						menu={{
+							selectedKeys: [theme],
+							items: [
+								{
+									key: 'system',
+									label: 'è·Ÿéšç³»ç»Ÿ',
+									icon: <LucideIcon name="screen-share" size={16} />,
+									onClick: () => handleThemeChange('system'),
+								},
+								{
+									key: 'light',
+									label: 'æµ…è‰²',
+									icon: <LucideIcon name="sun" size={16} />,
+									onClick: () => handleThemeChange('light'),
+								},
+								{
+									key: 'dark',
+									label: 'æ·±è‰²',
+									icon: <LucideIcon name="moon-star" size={16} />,
+									onClick: () => handleThemeChange('dark'),
+								},
+							],
+						}}
+					>
+						<div className="flex cursor-pointer items-center">
+							<LucideIcon
+								name={
+									theme === 'dark'
+										? 'moon-star'
+										: theme === 'light'
+											? 'sun'
+											: 'screen-share'
+								}
+								size={20}
+							/>
+						</div>
+					</Dropdown>
+					{/* è¯­è¨€åˆ‡æ¢ */}
+					<Dropdown
+						arrow
+						placement="bottomRight"
+						menu={{
+							selectedKeys: [language],
+							items: [
+								{
+									key: 'zh',
+									label: 'ä¸­æ–‡',
+									onClick: () => handleLanguageChange('zh'),
+								},
+								{
+									key: 'en',
+									label: 'English',
+									onClick: () => handleLanguageChange('en'),
+								},
+							],
+						}}
+					>
+						<div className="flex cursor-pointer items-center">
+							<LucideIcon
+								name="languages"
+								size={20}
+							/>
+						</div>
+					</Dropdown>
+				</Space>
+			</div>
+			{/* DifyChat ç»„ä»¶ */}
+			<div className="flex-1 overflow-hidden">
+				<DifyChat
+					apiBase={config.apiBase}
+					apiKey={config.apiKey}
+					user={config.user || undefined}
+					theme={theme}
+					language={language}
+					onError={e => console.error('DifyChat è¿æ¥é”™è¯¯:', e)}
+				/>
+			</div>
+		</div>
+	)
+}
-- 
2.51.0.windows.2

